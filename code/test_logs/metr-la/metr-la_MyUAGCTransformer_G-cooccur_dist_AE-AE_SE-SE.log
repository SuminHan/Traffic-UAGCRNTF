2023-06-02 23:24:04,255 - Namespace(dataset='metr-la', model_name='MyUAGCTransformer', graph_type='cooccur_dist', restore_model=False, train_again=False, activity_embedding=True, timestamp_embedding=False, sensor_embedding=True, sensor_node2vec=False, P=12, Q=12, D=64, K=8, d=8, L=3, K_diffusion=3, filter_type='dual_random_walk', train_ratio=0.7, val_ratio=0.1, test_ratio=0.2, batch_size=32, max_epoch=100, optimizer='adam', learning_rate=0.001, patience_stop=5, patience_lr=2, graph_file='../graph_generation/metr-la/urban_activity_sim_ua.pkl')
2023-06-02 23:24:13,720 - Callback method `on_train_batch_end` is slow compared to the batch time (batch time: 0.1508s vs `on_train_batch_end` time: 0.1529s). Check your callbacks.
2023-06-02 23:28:44,404 - Epoch 1: {'loss': 4.580938816070557, 'val_loss': 3.5767884254455566, 'lr': 0.001}
2023-06-02 23:33:17,150 - Epoch 2: {'loss': 3.409203052520752, 'val_loss': 3.136410713195801, 'lr': 0.001}
2023-06-02 23:37:50,218 - Epoch 3: {'loss': 3.213536024093628, 'val_loss': 3.024049997329712, 'lr': 0.001}
2023-06-02 23:42:22,977 - Epoch 4: {'loss': 3.114696741104126, 'val_loss': 2.923330545425415, 'lr': 0.001}
2023-06-02 23:46:55,995 - Epoch 5: {'loss': 3.0116689205169678, 'val_loss': 2.8479812145233154, 'lr': 0.001}
2023-06-02 23:51:28,765 - Epoch 6: {'loss': 2.9772067070007324, 'val_loss': 2.889369249343872, 'lr': 0.001}
2023-06-02 23:56:01,811 - Epoch 7: {'loss': 2.936189889907837, 'val_loss': 2.8149895668029785, 'lr': 0.001}
2023-06-03 00:00:35,141 - Epoch 8: {'loss': 2.92470121383667, 'val_loss': 2.9362220764160156, 'lr': 0.001}
2023-06-03 00:05:08,430 - Epoch 9: {'loss': 2.894373893737793, 'val_loss': 3.0614373683929443, 'lr': 0.001}
2023-06-03 00:09:42,074 - Epoch 10: {'loss': 2.7941670417785645, 'val_loss': 2.7114617824554443, 'lr': 0.000100000005}
2023-06-03 00:10:13,637 - Horizon 01 (MAE/RMSE/MAPE):	2.2498	3.9539	0.0540
2023-06-03 00:10:13,658 - Horizon 02 (MAE/RMSE/MAPE):	2.4910	4.6597	0.0617
2023-06-03 00:10:13,679 - Horizon 03 (MAE/RMSE/MAPE):	2.6555	5.1327	0.0677
2023-06-03 00:10:13,700 - Horizon 04 (MAE/RMSE/MAPE):	2.7858	5.5025	0.0726
2023-06-03 00:10:13,722 - Horizon 05 (MAE/RMSE/MAPE):	2.8935	5.8117	0.0771
2023-06-03 00:10:13,744 - Horizon 06 (MAE/RMSE/MAPE):	2.9852	6.0687	0.0809
2023-06-03 00:10:13,765 - Horizon 07 (MAE/RMSE/MAPE):	3.0684	6.2961	0.0844
2023-06-03 00:10:13,786 - Horizon 08 (MAE/RMSE/MAPE):	3.1402	6.4883	0.0874
2023-06-03 00:10:13,807 - Horizon 09 (MAE/RMSE/MAPE):	3.2046	6.6546	0.0902
2023-06-03 00:10:13,829 - Horizon 10 (MAE/RMSE/MAPE):	3.2649	6.8070	0.0928
2023-06-03 00:10:13,849 - Horizon 11 (MAE/RMSE/MAPE):	3.3205	6.9473	0.0953
2023-06-03 00:10:13,870 - Horizon 12 (MAE/RMSE/MAPE):	3.3729	7.0754	0.0973
2023-06-03 00:14:47,131 - Epoch 11: {'loss': 2.7694995403289795, 'val_loss': 2.693504571914673, 'lr': 0.000100000005}
2023-06-03 00:19:20,232 - Epoch 12: {'loss': 2.761101484298706, 'val_loss': 2.6997504234313965, 'lr': 0.000100000005}
2023-06-03 00:23:53,277 - Epoch 13: {'loss': 2.7526535987854004, 'val_loss': 2.6957590579986572, 'lr': 0.000100000005}
2023-06-03 00:28:26,629 - Epoch 14: {'loss': 2.734417676925659, 'val_loss': 2.6914732456207275, 'lr': 1.0000001e-05}
2023-06-03 00:32:59,652 - Epoch 15: {'loss': 2.7306995391845703, 'val_loss': 2.692535638809204, 'lr': 1.0000001e-05}
2023-06-03 00:37:32,662 - Epoch 16: {'loss': 2.729686737060547, 'val_loss': 2.6923985481262207, 'lr': 1.0000001e-05}
2023-06-03 00:42:06,149 - Epoch 17: {'loss': 2.7268404960632324, 'val_loss': 2.6904046535491943, 'lr': 1.0000001e-06}
2023-06-03 00:46:40,005 - Epoch 18: {'loss': 2.727121114730835, 'val_loss': 2.689910650253296, 'lr': 1.0000001e-06}
2023-06-03 00:51:13,508 - Epoch 19: {'loss': 2.727604389190674, 'val_loss': 2.690033435821533, 'lr': 1.0000001e-06}
2023-06-03 00:55:47,113 - Epoch 20: {'loss': 2.7268927097320557, 'val_loss': 2.6898539066314697, 'lr': 1.0000001e-06}
2023-06-03 00:56:17,704 - Horizon 01 (MAE/RMSE/MAPE):	2.2274	3.8970	0.0536
2023-06-03 00:56:17,724 - Horizon 02 (MAE/RMSE/MAPE):	2.4721	4.6094	0.0617
2023-06-03 00:56:17,744 - Horizon 03 (MAE/RMSE/MAPE):	2.6383	5.0973	0.0679
2023-06-03 00:56:17,764 - Horizon 04 (MAE/RMSE/MAPE):	2.7680	5.4725	0.0729
2023-06-03 00:56:17,784 - Horizon 05 (MAE/RMSE/MAPE):	2.8755	5.7871	0.0774
2023-06-03 00:56:17,803 - Horizon 06 (MAE/RMSE/MAPE):	2.9676	6.0518	0.0812
2023-06-03 00:56:17,823 - Horizon 07 (MAE/RMSE/MAPE):	3.0504	6.2798	0.0846
2023-06-03 00:56:17,843 - Horizon 08 (MAE/RMSE/MAPE):	3.1225	6.4747	0.0877
2023-06-03 00:56:17,864 - Horizon 09 (MAE/RMSE/MAPE):	3.1861	6.6439	0.0904
2023-06-03 00:56:17,884 - Horizon 10 (MAE/RMSE/MAPE):	3.2448	6.7967	0.0929
2023-06-03 00:56:17,903 - Horizon 11 (MAE/RMSE/MAPE):	3.3005	6.9382	0.0952
2023-06-03 00:56:17,923 - Horizon 12 (MAE/RMSE/MAPE):	3.3523	7.0678	0.0972
2023-06-03 01:00:51,527 - Epoch 21: {'loss': 2.7265801429748535, 'val_loss': 2.689758539199829, 'lr': 1.0000001e-07}
2023-06-03 01:05:25,381 - Epoch 22: {'loss': 2.7263636589050293, 'val_loss': 2.6897568702697754, 'lr': 1.0000001e-07}
2023-06-03 01:09:59,177 - Epoch 23: {'loss': 2.725503444671631, 'val_loss': 2.689692258834839, 'lr': 1.0000001e-07}
2023-06-03 01:14:33,044 - Epoch 24: {'loss': 2.726672887802124, 'val_loss': 2.6896889209747314, 'lr': 1.0000001e-08}
2023-06-03 01:19:06,852 - Epoch 25: {'loss': 2.7262003421783447, 'val_loss': 2.689674139022827, 'lr': 1.0000001e-08}
2023-06-03 01:23:40,790 - Epoch 26: {'loss': 2.7260496616363525, 'val_loss': 2.689673900604248, 'lr': 1.0000001e-09}
2023-06-03 01:28:14,864 - Epoch 27: {'loss': 2.726426124572754, 'val_loss': 2.6896727085113525, 'lr': 1.0000001e-09}
2023-06-03 01:32:48,916 - Epoch 28: {'loss': 2.7267422676086426, 'val_loss': 2.6896724700927734, 'lr': 1.0000001e-10}
2023-06-03 01:37:22,420 - Epoch 29: {'loss': 2.72647762298584, 'val_loss': 2.689674139022827, 'lr': 1.0000001e-10}
2023-06-03 01:41:56,364 - Epoch 30: {'loss': 2.7264301776885986, 'val_loss': 2.6896731853485107, 'lr': 1.0000001e-11}
2023-06-03 01:42:26,928 - Horizon 01 (MAE/RMSE/MAPE):	2.2273	3.8953	0.0537
2023-06-03 01:42:26,948 - Horizon 02 (MAE/RMSE/MAPE):	2.4720	4.6073	0.0617
2023-06-03 01:42:26,968 - Horizon 03 (MAE/RMSE/MAPE):	2.6381	5.0951	0.0679
2023-06-03 01:42:26,988 - Horizon 04 (MAE/RMSE/MAPE):	2.7678	5.4701	0.0729
2023-06-03 01:42:27,007 - Horizon 05 (MAE/RMSE/MAPE):	2.8752	5.7844	0.0774
2023-06-03 01:42:27,026 - Horizon 06 (MAE/RMSE/MAPE):	2.9673	6.0488	0.0812
2023-06-03 01:42:27,045 - Horizon 07 (MAE/RMSE/MAPE):	3.0501	6.2767	0.0846
2023-06-03 01:42:27,065 - Horizon 08 (MAE/RMSE/MAPE):	3.1222	6.4716	0.0877
2023-06-03 01:42:27,084 - Horizon 09 (MAE/RMSE/MAPE):	3.1857	6.6407	0.0904
2023-06-03 01:42:27,103 - Horizon 10 (MAE/RMSE/MAPE):	3.2444	6.7935	0.0929
2023-06-03 01:42:27,122 - Horizon 11 (MAE/RMSE/MAPE):	3.3000	6.9349	0.0952
2023-06-03 01:42:27,142 - Horizon 12 (MAE/RMSE/MAPE):	3.3518	7.0645	0.0972
2023-06-03 01:47:00,863 - Epoch 31: {'loss': 2.7263481616973877, 'val_loss': 2.6896719932556152, 'lr': 1.0000001e-11}
2023-06-03 01:51:34,528 - Epoch 32: {'loss': 2.726205587387085, 'val_loss': 2.689673900604248, 'lr': 1.0000001e-12}
2023-06-03 01:52:07,091 - Final test:
2023-06-03 01:52:07,153 - Horizon 01 (MAE/RMSE/MAPE):	2.2273	3.8953	0.0537
2023-06-03 01:52:07,210 - Horizon 02 (MAE/RMSE/MAPE):	2.4720	4.6073	0.0617
2023-06-03 01:52:07,268 - Horizon 03 (MAE/RMSE/MAPE):	2.6381	5.0951	0.0679
2023-06-03 01:52:07,327 - Horizon 04 (MAE/RMSE/MAPE):	2.7678	5.4701	0.0729
2023-06-03 01:52:07,385 - Horizon 05 (MAE/RMSE/MAPE):	2.8752	5.7844	0.0774
2023-06-03 01:52:07,442 - Horizon 06 (MAE/RMSE/MAPE):	2.9673	6.0488	0.0812
2023-06-03 01:52:07,499 - Horizon 07 (MAE/RMSE/MAPE):	3.0501	6.2767	0.0846
2023-06-03 01:52:07,557 - Horizon 08 (MAE/RMSE/MAPE):	3.1222	6.4715	0.0877
2023-06-03 01:52:07,614 - Horizon 09 (MAE/RMSE/MAPE):	3.1857	6.6407	0.0904
2023-06-03 01:52:07,673 - Horizon 10 (MAE/RMSE/MAPE):	3.2444	6.7935	0.0929
2023-06-03 01:52:07,731 - Horizon 11 (MAE/RMSE/MAPE):	3.3000	6.9349	0.0952
2023-06-03 01:52:07,789 - Horizon 12 (MAE/RMSE/MAPE):	3.3518	7.0645	0.0972
