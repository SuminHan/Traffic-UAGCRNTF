2023-06-03 14:51:26,381 - Namespace(dataset='pemsd7', model_name='MyUAGCTransformer', graph_type='legacy', restore_model=False, train_again=False, activity_embedding=True, timestamp_embedding=False, sensor_embedding=True, sensor_node2vec=False, P=12, Q=9, D=64, K=8, d=8, L=3, K_diffusion=3, filter_type='dual_random_walk', train_ratio=0.7, val_ratio=0.1, test_ratio=0.2, batch_size=32, max_epoch=100, optimizer='adam', learning_rate=0.001, patience_stop=5, patience_lr=2, graph_file='../graph_generation/pemsd7/original_adj_mx.pkl')
2023-06-03 14:51:34,204 - Callback method `on_train_batch_end` is slow compared to the batch time (batch time: 0.1439s vs `on_train_batch_end` time: 0.1548s). Check your callbacks.
2023-06-03 14:53:10,379 - Epoch 1: {'loss': 4.594095230102539, 'val_loss': 2.978243827819824, 'lr': 0.001}
2023-06-03 14:54:47,527 - Epoch 2: {'loss': 3.0193381309509277, 'val_loss': 2.9774842262268066, 'lr': 0.001}
2023-06-03 14:56:24,633 - Epoch 3: {'loss': 2.7987751960754395, 'val_loss': 2.7537484169006348, 'lr': 0.001}
2023-06-03 14:58:01,788 - Epoch 4: {'loss': 2.6971285343170166, 'val_loss': 2.662968397140503, 'lr': 0.001}
2023-06-03 14:59:39,168 - Epoch 5: {'loss': 2.5964531898498535, 'val_loss': 2.653632640838623, 'lr': 0.001}
2023-06-03 15:01:16,360 - Epoch 6: {'loss': 2.4989025592803955, 'val_loss': 2.5991909503936768, 'lr': 0.001}
2023-06-03 15:02:53,719 - Epoch 7: {'loss': 2.4653851985931396, 'val_loss': 2.5770440101623535, 'lr': 0.001}
2023-06-03 15:04:31,018 - Epoch 8: {'loss': 2.398219347000122, 'val_loss': 2.4917080402374268, 'lr': 0.001}
2023-06-03 15:06:08,170 - Epoch 9: {'loss': 2.3821091651916504, 'val_loss': 2.4568252563476562, 'lr': 0.001}
2023-06-03 15:07:45,427 - Epoch 10: {'loss': 2.3541200160980225, 'val_loss': 2.4496028423309326, 'lr': 0.001}
2023-06-03 15:07:56,779 - Horizon 01 (MAE/RMSE/MAPE):	1.4665	2.4375	0.0338
2023-06-03 15:07:56,786 - Horizon 02 (MAE/RMSE/MAPE):	1.8628	3.3349	0.0434
2023-06-03 15:07:56,793 - Horizon 03 (MAE/RMSE/MAPE):	2.1657	4.0393	0.0515
2023-06-03 15:07:56,800 - Horizon 04 (MAE/RMSE/MAPE):	2.3943	4.5709	0.0582
2023-06-03 15:07:56,807 - Horizon 05 (MAE/RMSE/MAPE):	2.5697	4.9825	0.0637
2023-06-03 15:07:56,814 - Horizon 06 (MAE/RMSE/MAPE):	2.7173	5.3233	0.0685
2023-06-03 15:07:56,820 - Horizon 07 (MAE/RMSE/MAPE):	2.8468	5.6109	0.0727
2023-06-03 15:07:56,827 - Horizon 08 (MAE/RMSE/MAPE):	2.9557	5.8379	0.0760
2023-06-03 15:07:56,834 - Horizon 09 (MAE/RMSE/MAPE):	3.0410	6.0045	0.0783
2023-06-03 15:09:33,781 - Epoch 11: {'loss': 2.321678638458252, 'val_loss': 2.4588773250579834, 'lr': 0.001}
2023-06-03 15:11:10,733 - Epoch 12: {'loss': 2.3046321868896484, 'val_loss': 2.4877259731292725, 'lr': 0.001}
2023-06-03 15:12:47,932 - Epoch 13: {'loss': 2.1992149353027344, 'val_loss': 2.382476568222046, 'lr': 0.000100000005}
2023-06-03 15:14:25,140 - Epoch 14: {'loss': 2.1878585815429688, 'val_loss': 2.375540256500244, 'lr': 0.000100000005}
2023-06-03 15:16:02,370 - Epoch 15: {'loss': 2.1831979751586914, 'val_loss': 2.359408378601074, 'lr': 0.000100000005}
2023-06-03 15:17:39,378 - Epoch 16: {'loss': 2.1782569885253906, 'val_loss': 2.3781604766845703, 'lr': 0.000100000005}
2023-06-03 15:19:16,216 - Epoch 17: {'loss': 2.1730337142944336, 'val_loss': 2.38027024269104, 'lr': 0.000100000005}
2023-06-03 15:20:53,103 - Epoch 18: {'loss': 2.161356210708618, 'val_loss': 2.360363245010376, 'lr': 1.0000001e-05}
2023-06-03 15:22:29,998 - Epoch 19: {'loss': 2.1598329544067383, 'val_loss': 2.3599143028259277, 'lr': 1.0000001e-05}
2023-06-03 15:24:07,220 - Epoch 20: {'loss': 2.158592700958252, 'val_loss': 2.358341693878174, 'lr': 1.0000001e-06}
2023-06-03 15:24:17,626 - Horizon 01 (MAE/RMSE/MAPE):	1.3648	2.3241	0.0309
2023-06-03 15:24:17,633 - Horizon 02 (MAE/RMSE/MAPE):	1.7837	3.2741	0.0413
2023-06-03 15:24:17,640 - Horizon 03 (MAE/RMSE/MAPE):	2.0984	4.0294	0.0501
2023-06-03 15:24:17,647 - Horizon 04 (MAE/RMSE/MAPE):	2.3254	4.5822	0.0570
2023-06-03 15:24:17,655 - Horizon 05 (MAE/RMSE/MAPE):	2.4947	4.9975	0.0622
2023-06-03 15:24:17,662 - Horizon 06 (MAE/RMSE/MAPE):	2.6309	5.3296	0.0666
2023-06-03 15:24:17,669 - Horizon 07 (MAE/RMSE/MAPE):	2.7477	5.6039	0.0704
2023-06-03 15:24:17,676 - Horizon 08 (MAE/RMSE/MAPE):	2.8461	5.8240	0.0735
2023-06-03 15:24:17,683 - Horizon 09 (MAE/RMSE/MAPE):	2.9240	5.9890	0.0758
2023-06-03 15:25:54,593 - Epoch 21: {'loss': 2.1584205627441406, 'val_loss': 2.3587822914123535, 'lr': 1.0000001e-06}
2023-06-03 15:27:31,566 - Epoch 22: {'loss': 2.157876491546631, 'val_loss': 2.3590314388275146, 'lr': 1.0000001e-06}
2023-06-03 15:29:08,445 - Epoch 23: {'loss': 2.1579644680023193, 'val_loss': 2.358903408050537, 'lr': 1.0000001e-07}
2023-06-03 15:30:45,440 - Epoch 24: {'loss': 2.1578209400177, 'val_loss': 2.3588144779205322, 'lr': 1.0000001e-07}
2023-06-03 15:32:22,375 - Epoch 25: {'loss': 2.157660484313965, 'val_loss': 2.3588147163391113, 'lr': 1.0000001e-08}
2023-06-03 15:32:34,736 - Final test:
2023-06-03 15:32:34,760 - Horizon 01 (MAE/RMSE/MAPE):	1.3648	2.3241	0.0309
2023-06-03 15:32:34,782 - Horizon 02 (MAE/RMSE/MAPE):	1.7837	3.2741	0.0413
2023-06-03 15:32:34,803 - Horizon 03 (MAE/RMSE/MAPE):	2.0984	4.0294	0.0501
2023-06-03 15:32:34,825 - Horizon 04 (MAE/RMSE/MAPE):	2.3254	4.5822	0.0570
2023-06-03 15:32:34,846 - Horizon 05 (MAE/RMSE/MAPE):	2.4947	4.9975	0.0622
2023-06-03 15:32:34,866 - Horizon 06 (MAE/RMSE/MAPE):	2.6310	5.3296	0.0666
2023-06-03 15:32:34,886 - Horizon 07 (MAE/RMSE/MAPE):	2.7477	5.6039	0.0704
2023-06-03 15:32:34,905 - Horizon 08 (MAE/RMSE/MAPE):	2.8461	5.8240	0.0735
2023-06-03 15:32:34,925 - Horizon 09 (MAE/RMSE/MAPE):	2.9240	5.9890	0.0758
