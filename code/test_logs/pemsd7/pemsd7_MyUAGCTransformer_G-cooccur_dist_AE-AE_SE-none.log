2023-06-03 16:14:01,395 - Namespace(dataset='pemsd7', model_name='MyUAGCTransformer', graph_type='cooccur_dist', restore_model=False, train_again=False, activity_embedding=True, timestamp_embedding=False, sensor_embedding=False, sensor_node2vec=False, P=12, Q=9, D=64, K=8, d=8, L=3, K_diffusion=3, filter_type='dual_random_walk', train_ratio=0.7, val_ratio=0.1, test_ratio=0.2, batch_size=32, max_epoch=100, optimizer='adam', learning_rate=0.001, patience_stop=5, patience_lr=2, graph_file='../graph_generation/pemsd7/urban_activity_sim_ua.pkl')
2023-06-03 16:14:09,003 - Callback method `on_train_batch_end` is slow compared to the batch time (batch time: 0.1451s vs `on_train_batch_end` time: 0.1565s). Check your callbacks.
2023-06-03 16:15:45,893 - Epoch 1: {'loss': 4.664978504180908, 'val_loss': 3.1803529262542725, 'lr': 0.001}
2023-06-03 16:17:23,679 - Epoch 2: {'loss': 2.9975051879882812, 'val_loss': 3.023699998855591, 'lr': 0.001}
2023-06-03 16:19:01,609 - Epoch 3: {'loss': 2.855849266052246, 'val_loss': 2.810239791870117, 'lr': 0.001}
2023-06-03 16:20:39,515 - Epoch 4: {'loss': 2.7949342727661133, 'val_loss': 2.7640795707702637, 'lr': 0.001}
2023-06-03 16:22:17,349 - Epoch 5: {'loss': 2.7340266704559326, 'val_loss': 2.7371010780334473, 'lr': 0.001}
2023-06-03 16:23:55,240 - Epoch 6: {'loss': 2.665910482406616, 'val_loss': 2.6582448482513428, 'lr': 0.001}
2023-06-03 16:25:32,800 - Epoch 7: {'loss': 2.644514322280884, 'val_loss': 2.697740316390991, 'lr': 0.001}
2023-06-03 16:27:10,439 - Epoch 8: {'loss': 2.6167712211608887, 'val_loss': 2.696335792541504, 'lr': 0.001}
2023-06-03 16:28:48,343 - Epoch 9: {'loss': 2.5172808170318604, 'val_loss': 2.57547664642334, 'lr': 0.000100000005}
2023-06-03 16:30:26,289 - Epoch 10: {'loss': 2.5065062046051025, 'val_loss': 2.572938919067383, 'lr': 0.000100000005}
2023-06-03 16:30:37,694 - Horizon 01 (MAE/RMSE/MAPE):	1.3884	2.3465	0.0315
2023-06-03 16:30:37,701 - Horizon 02 (MAE/RMSE/MAPE):	1.8349	3.3259	0.0423
2023-06-03 16:30:37,707 - Horizon 03 (MAE/RMSE/MAPE):	2.1825	4.1129	0.0515
2023-06-03 16:30:37,714 - Horizon 04 (MAE/RMSE/MAPE):	2.4695	4.7493	0.0597
2023-06-03 16:30:37,721 - Horizon 05 (MAE/RMSE/MAPE):	2.7076	5.2674	0.0669
2023-06-03 16:30:37,728 - Horizon 06 (MAE/RMSE/MAPE):	2.9173	5.7173	0.0735
2023-06-03 16:30:37,735 - Horizon 07 (MAE/RMSE/MAPE):	3.1092	6.1215	0.0798
2023-06-03 16:30:37,741 - Horizon 08 (MAE/RMSE/MAPE):	3.2810	6.4724	0.0854
2023-06-03 16:30:37,748 - Horizon 09 (MAE/RMSE/MAPE):	3.4328	6.7690	0.0902
2023-06-03 16:32:15,330 - Epoch 11: {'loss': 2.500013589859009, 'val_loss': 2.5765979290008545, 'lr': 0.000100000005}
2023-06-03 16:33:53,302 - Epoch 12: {'loss': 2.493133544921875, 'val_loss': 2.558875799179077, 'lr': 0.000100000005}
2023-06-03 16:35:30,973 - Epoch 13: {'loss': 2.4873452186584473, 'val_loss': 2.5641863346099854, 'lr': 0.000100000005}
2023-06-03 16:37:08,839 - Epoch 14: {'loss': 2.4798688888549805, 'val_loss': 2.550755739212036, 'lr': 0.000100000005}
2023-06-03 16:38:46,673 - Epoch 15: {'loss': 2.472134590148926, 'val_loss': 2.5413854122161865, 'lr': 0.000100000005}
2023-06-03 16:40:24,231 - Epoch 16: {'loss': 2.465538740158081, 'val_loss': 2.551417350769043, 'lr': 0.000100000005}
2023-06-03 16:42:02,060 - Epoch 17: {'loss': 2.458472967147827, 'val_loss': 2.5262155532836914, 'lr': 0.000100000005}
2023-06-03 16:43:39,697 - Epoch 18: {'loss': 2.449770450592041, 'val_loss': 2.538703203201294, 'lr': 0.000100000005}
2023-06-03 16:45:17,371 - Epoch 19: {'loss': 2.4458558559417725, 'val_loss': 2.530287742614746, 'lr': 0.000100000005}
2023-06-03 16:46:55,294 - Epoch 20: {'loss': 2.421266794204712, 'val_loss': 2.5167477130889893, 'lr': 1.0000001e-05}
2023-06-03 16:47:05,771 - Horizon 01 (MAE/RMSE/MAPE):	1.3631	2.3080	0.0307
2023-06-03 16:47:05,778 - Horizon 02 (MAE/RMSE/MAPE):	1.8128	3.2895	0.0414
2023-06-03 16:47:05,784 - Horizon 03 (MAE/RMSE/MAPE):	2.1574	4.0598	0.0507
2023-06-03 16:47:05,791 - Horizon 04 (MAE/RMSE/MAPE):	2.4341	4.6779	0.0590
2023-06-03 16:47:05,798 - Horizon 05 (MAE/RMSE/MAPE):	2.6567	5.1693	0.0658
2023-06-03 16:47:05,805 - Horizon 06 (MAE/RMSE/MAPE):	2.8515	5.5902	0.0719
2023-06-03 16:47:05,812 - Horizon 07 (MAE/RMSE/MAPE):	3.0244	5.9510	0.0774
2023-06-03 16:47:05,818 - Horizon 08 (MAE/RMSE/MAPE):	3.1788	6.2614	0.0823
2023-06-03 16:47:05,825 - Horizon 09 (MAE/RMSE/MAPE):	3.3174	6.5319	0.0868
2023-06-03 16:48:43,544 - Epoch 21: {'loss': 2.4191231727600098, 'val_loss': 2.5184614658355713, 'lr': 1.0000001e-05}
2023-06-03 16:50:21,633 - Epoch 22: {'loss': 2.4173593521118164, 'val_loss': 2.511443853378296, 'lr': 1.0000001e-05}
2023-06-03 16:51:59,292 - Epoch 23: {'loss': 2.416764259338379, 'val_loss': 2.520756483078003, 'lr': 1.0000001e-05}
2023-06-03 16:53:36,904 - Epoch 24: {'loss': 2.415520429611206, 'val_loss': 2.514751434326172, 'lr': 1.0000001e-05}
2023-06-03 16:55:14,405 - Epoch 25: {'loss': 2.413069725036621, 'val_loss': 2.5141263008117676, 'lr': 1.0000001e-06}
2023-06-03 16:56:52,045 - Epoch 26: {'loss': 2.4118900299072266, 'val_loss': 2.511734962463379, 'lr': 1.0000001e-06}
2023-06-03 16:58:29,660 - Epoch 27: {'loss': 2.412348985671997, 'val_loss': 2.5120906829833984, 'lr': 1.0000001e-07}
2023-06-03 16:58:42,062 - Final test:
2023-06-03 16:58:42,082 - Horizon 01 (MAE/RMSE/MAPE):	1.3610	2.3111	0.0305
2023-06-03 16:58:42,102 - Horizon 02 (MAE/RMSE/MAPE):	1.8126	3.2965	0.0413
2023-06-03 16:58:42,121 - Horizon 03 (MAE/RMSE/MAPE):	2.1565	4.0646	0.0505
2023-06-03 16:58:42,141 - Horizon 04 (MAE/RMSE/MAPE):	2.4309	4.6776	0.0587
2023-06-03 16:58:42,160 - Horizon 05 (MAE/RMSE/MAPE):	2.6516	5.1647	0.0655
2023-06-03 16:58:42,179 - Horizon 06 (MAE/RMSE/MAPE):	2.8436	5.5803	0.0715
2023-06-03 16:58:42,198 - Horizon 07 (MAE/RMSE/MAPE):	3.0141	5.9367	0.0769
2023-06-03 16:58:42,217 - Horizon 08 (MAE/RMSE/MAPE):	3.1676	6.2444	0.0818
2023-06-03 16:58:42,236 - Horizon 09 (MAE/RMSE/MAPE):	3.3060	6.5149	0.0862
