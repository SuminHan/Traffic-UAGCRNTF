2023-06-03 14:33:39,724 - Namespace(dataset='pems-bay', model_name='MyUAGCTransformer', graph_type='legacy', restore_model=False, train_again=False, activity_embedding=True, timestamp_embedding=False, sensor_embedding=True, sensor_node2vec=False, P=12, Q=12, D=64, K=8, d=8, L=3, K_diffusion=3, filter_type='dual_random_walk', train_ratio=0.7, val_ratio=0.1, test_ratio=0.2, batch_size=32, max_epoch=100, optimizer='adam', learning_rate=0.001, patience_stop=5, patience_lr=2, graph_file='../graph_generation/pems-bay/original_adj_mx.pkl')
2023-06-03 14:33:50,735 - Callback method `on_train_batch_end` is slow compared to the batch time (batch time: 0.2103s vs `on_train_batch_end` time: 0.2200s). Check your callbacks.
2023-06-03 14:43:24,900 - Epoch 1: {'loss': 2.3443763256073, 'val_loss': 2.2638702392578125, 'lr': 0.001}
2023-06-03 14:53:00,710 - Epoch 2: {'loss': 1.8216325044631958, 'val_loss': 1.8690063953399658, 'lr': 0.001}
2023-06-03 15:02:37,950 - Epoch 3: {'loss': 1.7145546674728394, 'val_loss': 1.7699002027511597, 'lr': 0.001}
2023-06-03 15:12:15,779 - Epoch 4: {'loss': 1.645917534828186, 'val_loss': 1.69658625125885, 'lr': 0.001}
2023-06-03 15:21:53,482 - Epoch 5: {'loss': 1.6165083646774292, 'val_loss': 1.6931977272033691, 'lr': 0.001}
2023-06-03 15:31:30,947 - Epoch 6: {'loss': 1.5827988386154175, 'val_loss': 1.701684832572937, 'lr': 0.001}
2023-06-03 15:41:08,667 - Epoch 7: {'loss': 1.5686585903167725, 'val_loss': 1.668330430984497, 'lr': 0.001}
2023-06-03 15:50:46,567 - Epoch 8: {'loss': 1.5538339614868164, 'val_loss': 1.6510608196258545, 'lr': 0.001}
2023-06-03 16:00:25,070 - Epoch 9: {'loss': 1.5372686386108398, 'val_loss': 1.6254900693893433, 'lr': 0.001}
2023-06-03 16:10:03,053 - Epoch 10: {'loss': 1.5227184295654297, 'val_loss': 1.6012078523635864, 'lr': 0.001}
2023-06-03 16:11:08,082 - Horizon 01 (MAE/RMSE/MAPE):	0.9138	1.6382	0.0181
2023-06-03 16:11:08,140 - Horizon 02 (MAE/RMSE/MAPE):	1.1553	2.2874	0.0234
2023-06-03 16:11:08,198 - Horizon 03 (MAE/RMSE/MAPE):	1.3319	2.8095	0.0279
2023-06-03 16:11:08,257 - Horizon 04 (MAE/RMSE/MAPE):	1.4589	3.1939	0.0313
2023-06-03 16:11:08,315 - Horizon 05 (MAE/RMSE/MAPE):	1.5529	3.4787	0.0339
2023-06-03 16:11:08,373 - Horizon 06 (MAE/RMSE/MAPE):	1.6272	3.6958	0.0361
2023-06-03 16:11:08,430 - Horizon 07 (MAE/RMSE/MAPE):	1.6879	3.8652	0.0379
2023-06-03 16:11:08,489 - Horizon 08 (MAE/RMSE/MAPE):	1.7383	3.9995	0.0394
2023-06-03 16:11:08,548 - Horizon 09 (MAE/RMSE/MAPE):	1.7816	4.1092	0.0406
2023-06-03 16:11:08,605 - Horizon 10 (MAE/RMSE/MAPE):	1.8195	4.2005	0.0417
2023-06-03 16:11:08,663 - Horizon 11 (MAE/RMSE/MAPE):	1.8524	4.2732	0.0426
2023-06-03 16:11:08,722 - Horizon 12 (MAE/RMSE/MAPE):	1.8813	4.3304	0.0434
2023-06-03 16:20:46,334 - Epoch 11: {'loss': 1.514343023300171, 'val_loss': 1.6078258752822876, 'lr': 0.001}
2023-06-03 16:30:24,156 - Epoch 12: {'loss': 1.5012847185134888, 'val_loss': 1.6078271865844727, 'lr': 0.001}
2023-06-03 16:40:02,458 - Epoch 13: {'loss': 1.4378832578659058, 'val_loss': 1.5534865856170654, 'lr': 0.000100000005}
2023-06-03 16:49:40,287 - Epoch 14: {'loss': 1.4274406433105469, 'val_loss': 1.5558029413223267, 'lr': 0.000100000005}
2023-06-03 16:59:18,576 - Epoch 15: {'loss': 1.4230037927627563, 'val_loss': 1.5492808818817139, 'lr': 0.000100000005}
2023-06-03 17:08:56,670 - Epoch 16: {'loss': 1.4187270402908325, 'val_loss': 1.5471227169036865, 'lr': 0.000100000005}
2023-06-03 17:18:34,719 - Epoch 17: {'loss': 1.4145278930664062, 'val_loss': 1.5451291799545288, 'lr': 0.000100000005}
2023-06-03 17:28:12,413 - Epoch 18: {'loss': 1.411106824874878, 'val_loss': 1.5467796325683594, 'lr': 0.000100000005}
2023-06-03 17:37:49,997 - Epoch 19: {'loss': 1.4076356887817383, 'val_loss': 1.5465642213821411, 'lr': 0.000100000005}
2023-06-03 17:47:28,125 - Epoch 20: {'loss': 1.3970274925231934, 'val_loss': 1.5397695302963257, 'lr': 1.0000001e-05}
2023-06-03 17:48:32,826 - Horizon 01 (MAE/RMSE/MAPE):	0.8763	1.5828	0.0171
2023-06-03 17:48:33,030 - Horizon 02 (MAE/RMSE/MAPE):	1.1244	2.2336	0.0227
2023-06-03 17:48:33,162 - Horizon 03 (MAE/RMSE/MAPE):	1.3042	2.7669	0.0274
2023-06-03 17:48:33,332 - Horizon 04 (MAE/RMSE/MAPE):	1.4316	3.1612	0.0310
2023-06-03 17:48:33,454 - Horizon 05 (MAE/RMSE/MAPE):	1.5275	3.4582	0.0338
2023-06-03 17:48:33,620 - Horizon 06 (MAE/RMSE/MAPE):	1.6026	3.6818	0.0361
2023-06-03 17:48:33,794 - Horizon 07 (MAE/RMSE/MAPE):	1.6627	3.8543	0.0379
2023-06-03 17:48:33,939 - Horizon 08 (MAE/RMSE/MAPE):	1.7125	3.9915	0.0395
2023-06-03 17:48:34,101 - Horizon 09 (MAE/RMSE/MAPE):	1.7541	4.0985	0.0408
2023-06-03 17:48:34,219 - Horizon 10 (MAE/RMSE/MAPE):	1.7904	4.1863	0.0419
2023-06-03 17:48:34,396 - Horizon 11 (MAE/RMSE/MAPE):	1.8233	4.2619	0.0429
2023-06-03 17:48:34,527 - Horizon 12 (MAE/RMSE/MAPE):	1.8496	4.3175	0.0436
2023-06-03 17:58:12,076 - Epoch 21: {'loss': 1.3956990242004395, 'val_loss': 1.5404479503631592, 'lr': 1.0000001e-05}
2023-06-03 18:07:49,850 - Epoch 22: {'loss': 1.3950328826904297, 'val_loss': 1.5390357971191406, 'lr': 1.0000001e-05}
2023-06-03 18:17:27,791 - Epoch 23: {'loss': 1.3942228555679321, 'val_loss': 1.5384677648544312, 'lr': 1.0000001e-05}
2023-06-03 18:27:05,537 - Epoch 24: {'loss': 1.3938722610473633, 'val_loss': 1.5401051044464111, 'lr': 1.0000001e-05}
2023-06-03 18:36:43,209 - Epoch 25: {'loss': 1.3932092189788818, 'val_loss': 1.5409742593765259, 'lr': 1.0000001e-05}
2023-06-03 18:46:20,653 - Epoch 26: {'loss': 1.3920879364013672, 'val_loss': 1.5397332906723022, 'lr': 1.0000001e-06}
2023-06-03 18:55:58,110 - Epoch 27: {'loss': 1.3919854164123535, 'val_loss': 1.5400046110153198, 'lr': 1.0000001e-06}
2023-06-03 19:05:35,239 - Epoch 28: {'loss': 1.3916218280792236, 'val_loss': 1.5397875308990479, 'lr': 1.0000001e-07}
2023-06-03 19:06:42,893 - Final test:
2023-06-03 19:06:43,442 - Horizon 01 (MAE/RMSE/MAPE):	0.8760	1.5826	0.0171
2023-06-03 19:06:43,940 - Horizon 02 (MAE/RMSE/MAPE):	1.1239	2.2339	0.0227
2023-06-03 19:06:44,467 - Horizon 03 (MAE/RMSE/MAPE):	1.3047	2.7714	0.0274
2023-06-03 19:06:44,917 - Horizon 04 (MAE/RMSE/MAPE):	1.4322	3.1661	0.0310
2023-06-03 19:06:45,451 - Horizon 05 (MAE/RMSE/MAPE):	1.5278	3.4619	0.0338
2023-06-03 19:06:45,927 - Horizon 06 (MAE/RMSE/MAPE):	1.6029	3.6851	0.0360
2023-06-03 19:06:46,420 - Horizon 07 (MAE/RMSE/MAPE):	1.6630	3.8579	0.0379
2023-06-03 19:06:46,882 - Horizon 08 (MAE/RMSE/MAPE):	1.7131	3.9957	0.0394
2023-06-03 19:06:47,290 - Horizon 09 (MAE/RMSE/MAPE):	1.7548	4.1034	0.0407
2023-06-03 19:06:47,744 - Horizon 10 (MAE/RMSE/MAPE):	1.7916	4.1923	0.0418
2023-06-03 19:06:48,173 - Horizon 11 (MAE/RMSE/MAPE):	1.8247	4.2689	0.0428
2023-06-03 19:06:48,585 - Horizon 12 (MAE/RMSE/MAPE):	1.8512	4.3256	0.0436
