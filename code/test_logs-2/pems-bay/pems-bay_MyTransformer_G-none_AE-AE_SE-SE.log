2023-05-29 01:27:54,634 - Namespace(dataset='pems-bay', model_name='MyTransformer', graph_type='none', restore_model=False, activity_embedding=True, timestamp_embedding=False, sensor_embedding=True, sensor_node2vec=False, P=12, Q=12, D=64, K=8, d=8, L=3, K_diffusion=3, filter_type='dual_random_walk', train_ratio=0.7, val_ratio=0.1, test_ratio=0.2, batch_size=32, max_epoch=100, optimizer='adam', learning_rate=0.001, patience_stop=5, patience_lr=2)
2023-05-29 01:28:03,148 - Callback method `on_train_batch_end` is slow compared to the batch time (batch time: 0.1848s vs `on_train_batch_end` time: 0.2280s). Check your callbacks.
2023-05-29 01:37:21,110 - Epoch 1: {'loss': 1.732397437095642, 'val_loss': 1.8267319202423096, 'lr': 0.001}
2023-05-29 01:46:41,237 - Epoch 2: {'loss': 1.6662003993988037, 'val_loss': 1.7671555280685425, 'lr': 0.001}
2023-05-29 01:56:01,442 - Epoch 3: {'loss': 1.634018898010254, 'val_loss': 1.7131547927856445, 'lr': 0.001}
2023-05-29 02:05:21,423 - Epoch 4: {'loss': 1.6116464138031006, 'val_loss': 1.686313509941101, 'lr': 0.001}
2023-05-29 02:14:41,398 - Epoch 5: {'loss': 1.5963170528411865, 'val_loss': 1.71926748752594, 'lr': 0.001}
2023-05-29 02:24:01,522 - Epoch 6: {'loss': 1.583282470703125, 'val_loss': 1.6457467079162598, 'lr': 0.001}
2023-05-29 02:33:21,679 - Epoch 7: {'loss': 1.5725435018539429, 'val_loss': 1.6765645742416382, 'lr': 0.001}
2023-05-29 02:42:41,860 - Epoch 8: {'loss': 1.5622100830078125, 'val_loss': 1.70846688747406, 'lr': 0.001}
2023-05-29 02:52:02,067 - Epoch 9: {'loss': 1.5060417652130127, 'val_loss': 1.6055378913879395, 'lr': 0.000100000005}
2023-05-29 03:01:21,977 - Epoch 10: {'loss': 1.4989656209945679, 'val_loss': 1.6064233779907227, 'lr': 0.000100000005}
2023-05-29 03:02:21,053 - Horizon 01 (MAE/RMSE/MAPE):	0.8900	1.6074	0.0176
2023-05-29 03:02:21,109 - Horizon 02 (MAE/RMSE/MAPE):	1.1526	2.3107	0.0236
2023-05-29 03:02:21,165 - Horizon 03 (MAE/RMSE/MAPE):	1.3366	2.8539	0.0285
2023-05-29 03:02:21,222 - Horizon 04 (MAE/RMSE/MAPE):	1.4691	3.2592	0.0323
2023-05-29 03:02:21,279 - Horizon 05 (MAE/RMSE/MAPE):	1.5681	3.5619	0.0353
2023-05-29 03:02:21,335 - Horizon 06 (MAE/RMSE/MAPE):	1.6443	3.7860	0.0376
2023-05-29 03:02:21,390 - Horizon 07 (MAE/RMSE/MAPE):	1.7057	3.9588	0.0395
2023-05-29 03:02:21,447 - Horizon 08 (MAE/RMSE/MAPE):	1.7556	4.0936	0.0411
2023-05-29 03:02:21,503 - Horizon 09 (MAE/RMSE/MAPE):	1.7965	4.1968	0.0423
2023-05-29 03:02:21,559 - Horizon 10 (MAE/RMSE/MAPE):	1.8316	4.2806	0.0433
2023-05-29 03:02:21,615 - Horizon 11 (MAE/RMSE/MAPE):	1.8634	4.3510	0.0442
2023-05-29 03:02:21,672 - Horizon 12 (MAE/RMSE/MAPE):	1.8937	4.4131	0.0450
2023-05-29 03:11:41,687 - Epoch 11: {'loss': 1.4955705404281616, 'val_loss': 1.596357822418213, 'lr': 0.000100000005}
2023-05-29 03:21:01,955 - Epoch 12: {'loss': 1.4933078289031982, 'val_loss': 1.5928810834884644, 'lr': 0.000100000005}
2023-05-29 03:30:21,990 - Epoch 13: {'loss': 1.4906318187713623, 'val_loss': 1.596211314201355, 'lr': 0.000100000005}
2023-05-29 03:39:42,109 - Epoch 14: {'loss': 1.4885979890823364, 'val_loss': 1.6020712852478027, 'lr': 0.000100000005}
2023-05-29 03:49:02,364 - Epoch 15: {'loss': 1.4807782173156738, 'val_loss': 1.5925889015197754, 'lr': 1.0000001e-05}
2023-05-29 03:58:22,308 - Epoch 16: {'loss': 1.4797766208648682, 'val_loss': 1.592753529548645, 'lr': 1.0000001e-05}
2023-05-29 04:07:42,338 - Epoch 17: {'loss': 1.4791324138641357, 'val_loss': 1.5887614488601685, 'lr': 1.0000001e-05}
2023-05-29 04:17:02,223 - Epoch 18: {'loss': 1.478598952293396, 'val_loss': 1.5894616842269897, 'lr': 1.0000001e-05}
2023-05-29 04:26:22,769 - Epoch 19: {'loss': 1.4783686399459839, 'val_loss': 1.5865821838378906, 'lr': 1.0000001e-05}
2023-05-29 04:35:42,990 - Epoch 20: {'loss': 1.478291630744934, 'val_loss': 1.588573932647705, 'lr': 1.0000001e-05}
2023-05-29 04:36:41,944 - Horizon 01 (MAE/RMSE/MAPE):	0.8778	1.5960	0.0171
2023-05-29 04:36:42,001 - Horizon 02 (MAE/RMSE/MAPE):	1.1438	2.3076	0.0233
2023-05-29 04:36:42,058 - Horizon 03 (MAE/RMSE/MAPE):	1.3289	2.8562	0.0282
2023-05-29 04:36:42,116 - Horizon 04 (MAE/RMSE/MAPE):	1.4632	3.2710	0.0320
2023-05-29 04:36:42,174 - Horizon 05 (MAE/RMSE/MAPE):	1.5628	3.5768	0.0351
2023-05-29 04:36:42,231 - Horizon 06 (MAE/RMSE/MAPE):	1.6386	3.8008	0.0374
2023-05-29 04:36:42,288 - Horizon 07 (MAE/RMSE/MAPE):	1.6997	3.9742	0.0392
2023-05-29 04:36:42,347 - Horizon 08 (MAE/RMSE/MAPE):	1.7495	4.1088	0.0408
2023-05-29 04:36:42,405 - Horizon 09 (MAE/RMSE/MAPE):	1.7899	4.2109	0.0419
2023-05-29 04:36:42,462 - Horizon 10 (MAE/RMSE/MAPE):	1.8243	4.2933	0.0429
2023-05-29 04:36:42,519 - Horizon 11 (MAE/RMSE/MAPE):	1.8551	4.3622	0.0438
2023-05-29 04:36:42,578 - Horizon 12 (MAE/RMSE/MAPE):	1.8840	4.4222	0.0445
2023-05-29 04:46:02,988 - Epoch 21: {'loss': 1.4778372049331665, 'val_loss': 1.5884922742843628, 'lr': 1.0000001e-05}
2023-05-29 04:55:23,490 - Epoch 22: {'loss': 1.4770638942718506, 'val_loss': 1.5880448818206787, 'lr': 1.0000001e-06}
2023-05-29 05:04:43,860 - Epoch 23: {'loss': 1.4769788980484009, 'val_loss': 1.5878283977508545, 'lr': 1.0000001e-06}
2023-05-29 05:14:04,400 - Epoch 24: {'loss': 1.476790189743042, 'val_loss': 1.5878812074661255, 'lr': 1.0000001e-07}
2023-05-29 05:15:04,897 - Final test:
2023-05-29 05:15:05,066 - Horizon 01 (MAE/RMSE/MAPE):	0.8767	1.5937	0.0170
2023-05-29 05:15:05,235 - Horizon 02 (MAE/RMSE/MAPE):	1.1423	2.3034	0.0232
2023-05-29 05:15:05,406 - Horizon 03 (MAE/RMSE/MAPE):	1.3259	2.8461	0.0281
2023-05-29 05:15:05,578 - Horizon 04 (MAE/RMSE/MAPE):	1.4594	3.2573	0.0319
2023-05-29 05:15:05,749 - Horizon 05 (MAE/RMSE/MAPE):	1.5584	3.5610	0.0349
2023-05-29 05:15:05,918 - Horizon 06 (MAE/RMSE/MAPE):	1.6340	3.7841	0.0372
2023-05-29 05:15:06,088 - Horizon 07 (MAE/RMSE/MAPE):	1.6949	3.9569	0.0390
2023-05-29 05:15:06,260 - Horizon 08 (MAE/RMSE/MAPE):	1.7444	4.0907	0.0406
2023-05-29 05:15:06,432 - Horizon 09 (MAE/RMSE/MAPE):	1.7848	4.1924	0.0417
2023-05-29 05:15:06,601 - Horizon 10 (MAE/RMSE/MAPE):	1.8191	4.2743	0.0427
2023-05-29 05:15:06,772 - Horizon 11 (MAE/RMSE/MAPE):	1.8498	4.3424	0.0436
2023-05-29 05:15:06,943 - Horizon 12 (MAE/RMSE/MAPE):	1.8788	4.4027	0.0443
