2023-05-29 01:28:00,362 - Namespace(dataset='pems-bay', model_name='MyTransformer', graph_type='none', restore_model=False, activity_embedding=True, timestamp_embedding=False, sensor_embedding=False, sensor_node2vec=False, P=12, Q=12, D=64, K=8, d=8, L=3, K_diffusion=3, filter_type='dual_random_walk', train_ratio=0.7, val_ratio=0.1, test_ratio=0.2, batch_size=32, max_epoch=100, optimizer='adam', learning_rate=0.001, patience_stop=5, patience_lr=2)
2023-05-29 01:28:08,498 - Callback method `on_train_batch_end` is slow compared to the batch time (batch time: 0.1844s vs `on_train_batch_end` time: 0.2246s). Check your callbacks.
2023-05-29 01:37:18,090 - Epoch 1: {'loss': 2.17952036857605, 'val_loss': 2.0587871074676514, 'lr': 0.001}
2023-05-29 01:46:28,223 - Epoch 2: {'loss': 1.8904035091400146, 'val_loss': 2.028104305267334, 'lr': 0.001}
2023-05-29 01:55:38,380 - Epoch 3: {'loss': 1.8588461875915527, 'val_loss': 2.0104899406433105, 'lr': 0.001}
2023-05-29 02:04:48,679 - Epoch 4: {'loss': 1.8389739990234375, 'val_loss': 1.9780323505401611, 'lr': 0.001}
2023-05-29 02:13:59,104 - Epoch 5: {'loss': 1.8278642892837524, 'val_loss': 1.9746633768081665, 'lr': 0.001}
2023-05-29 02:23:09,386 - Epoch 6: {'loss': 1.819658637046814, 'val_loss': 1.9603711366653442, 'lr': 0.001}
2023-05-29 02:32:21,447 - Epoch 7: {'loss': 1.8118069171905518, 'val_loss': 1.957028865814209, 'lr': 0.001}
2023-05-29 02:41:33,251 - Epoch 8: {'loss': 1.806575894355774, 'val_loss': 1.9737074375152588, 'lr': 0.001}
2023-05-29 02:50:45,106 - Epoch 9: {'loss': 1.8005467653274536, 'val_loss': 1.9492121934890747, 'lr': 0.001}
2023-05-29 02:59:57,057 - Epoch 10: {'loss': 1.7959843873977661, 'val_loss': 1.937774658203125, 'lr': 0.001}
2023-05-29 03:00:55,523 - Horizon 01 (MAE/RMSE/MAPE):	0.8901	1.6224	0.0175
2023-05-29 03:00:55,580 - Horizon 02 (MAE/RMSE/MAPE):	1.1882	2.4070	0.0242
2023-05-29 03:00:55,637 - Horizon 03 (MAE/RMSE/MAPE):	1.4073	3.0287	0.0298
2023-05-29 03:00:55,694 - Horizon 04 (MAE/RMSE/MAPE):	1.5778	3.5173	0.0344
2023-05-29 03:00:55,751 - Horizon 05 (MAE/RMSE/MAPE):	1.7199	3.9083	0.0386
2023-05-29 03:00:55,807 - Horizon 06 (MAE/RMSE/MAPE):	1.8421	4.2262	0.0424
2023-05-29 03:00:55,863 - Horizon 07 (MAE/RMSE/MAPE):	1.9494	4.4927	0.0457
2023-05-29 03:00:55,920 - Horizon 08 (MAE/RMSE/MAPE):	2.0452	4.7231	0.0488
2023-05-29 03:00:55,978 - Horizon 09 (MAE/RMSE/MAPE):	2.1300	4.9235	0.0516
2023-05-29 03:00:56,034 - Horizon 10 (MAE/RMSE/MAPE):	2.2074	5.1020	0.0541
2023-05-29 03:00:56,090 - Horizon 11 (MAE/RMSE/MAPE):	2.2805	5.2628	0.0566
2023-05-29 03:00:56,148 - Horizon 12 (MAE/RMSE/MAPE):	2.3491	5.4064	0.0586
2023-05-29 03:10:08,125 - Epoch 11: {'loss': 1.7922743558883667, 'val_loss': 1.9567828178405762, 'lr': 0.001}
2023-05-29 03:19:20,251 - Epoch 12: {'loss': 1.7885879278182983, 'val_loss': 1.943162202835083, 'lr': 0.001}
2023-05-29 03:28:32,742 - Epoch 13: {'loss': 1.7604230642318726, 'val_loss': 1.9184954166412354, 'lr': 0.000100000005}
2023-05-29 03:37:44,917 - Epoch 14: {'loss': 1.7568557262420654, 'val_loss': 1.9101588726043701, 'lr': 0.000100000005}
2023-05-29 03:46:57,120 - Epoch 15: {'loss': 1.755193829536438, 'val_loss': 1.9132606983184814, 'lr': 0.000100000005}
2023-05-29 03:56:09,212 - Epoch 16: {'loss': 1.7539368867874146, 'val_loss': 1.9085456132888794, 'lr': 0.000100000005}
2023-05-29 04:05:21,353 - Epoch 17: {'loss': 1.752373456954956, 'val_loss': 1.909346580505371, 'lr': 0.000100000005}
2023-05-29 04:14:33,622 - Epoch 18: {'loss': 1.7513495683670044, 'val_loss': 1.9076772928237915, 'lr': 0.000100000005}
2023-05-29 04:23:45,730 - Epoch 19: {'loss': 1.750124216079712, 'val_loss': 1.9056280851364136, 'lr': 0.000100000005}
2023-05-29 04:32:57,865 - Epoch 20: {'loss': 1.74894118309021, 'val_loss': 1.9051494598388672, 'lr': 0.000100000005}
2023-05-29 04:33:55,809 - Horizon 01 (MAE/RMSE/MAPE):	0.8729	1.6116	0.0167
2023-05-29 04:33:55,865 - Horizon 02 (MAE/RMSE/MAPE):	1.1692	2.3934	0.0234
2023-05-29 04:33:55,921 - Horizon 03 (MAE/RMSE/MAPE):	1.3849	3.0088	0.0288
2023-05-29 04:33:55,978 - Horizon 04 (MAE/RMSE/MAPE):	1.5546	3.4964	0.0333
2023-05-29 04:33:56,036 - Horizon 05 (MAE/RMSE/MAPE):	1.6938	3.8792	0.0373
2023-05-29 04:33:56,092 - Horizon 06 (MAE/RMSE/MAPE):	1.8122	4.1863	0.0408
2023-05-29 04:33:56,148 - Horizon 07 (MAE/RMSE/MAPE):	1.9162	4.4441	0.0439
2023-05-29 04:33:56,206 - Horizon 08 (MAE/RMSE/MAPE):	2.0090	4.6636	0.0468
2023-05-29 04:33:56,263 - Horizon 09 (MAE/RMSE/MAPE):	2.0923	4.8520	0.0494
2023-05-29 04:33:56,319 - Horizon 10 (MAE/RMSE/MAPE):	2.1689	5.0215	0.0518
2023-05-29 04:33:56,374 - Horizon 11 (MAE/RMSE/MAPE):	2.2401	5.1774	0.0542
2023-05-29 04:33:56,431 - Horizon 12 (MAE/RMSE/MAPE):	2.3083	5.3243	0.0564
2023-05-29 04:43:08,474 - Epoch 21: {'loss': 1.7483404874801636, 'val_loss': 1.9049620628356934, 'lr': 0.000100000005}
2023-05-29 04:52:20,523 - Epoch 22: {'loss': 1.7472254037857056, 'val_loss': 1.9072861671447754, 'lr': 0.000100000005}
2023-05-29 05:01:32,290 - Epoch 23: {'loss': 1.7464492321014404, 'val_loss': 1.9060643911361694, 'lr': 0.000100000005}
2023-05-29 05:10:44,565 - Epoch 24: {'loss': 1.7418601512908936, 'val_loss': 1.9015616178512573, 'lr': 1.0000001e-05}
2023-05-29 05:19:55,974 - Epoch 25: {'loss': 1.7412735223770142, 'val_loss': 1.9019393920898438, 'lr': 1.0000001e-05}
2023-05-29 05:29:07,848 - Epoch 26: {'loss': 1.7409368753433228, 'val_loss': 1.903195858001709, 'lr': 1.0000001e-05}
2023-05-29 05:38:19,756 - Epoch 27: {'loss': 1.7405084371566772, 'val_loss': 1.901808261871338, 'lr': 1.0000001e-06}
2023-05-29 05:47:31,804 - Epoch 28: {'loss': 1.7403844594955444, 'val_loss': 1.9015430212020874, 'lr': 1.0000001e-06}
2023-05-29 05:56:44,102 - Epoch 29: {'loss': 1.740313172340393, 'val_loss': 1.9015252590179443, 'lr': 1.0000001e-07}
2023-05-29 06:05:56,206 - Epoch 30: {'loss': 1.7403440475463867, 'val_loss': 1.901507019996643, 'lr': 1.0000001e-07}
2023-05-29 06:06:53,932 - Horizon 01 (MAE/RMSE/MAPE):	0.8708	1.6031	0.0167
2023-05-29 06:06:53,990 - Horizon 02 (MAE/RMSE/MAPE):	1.1679	2.3835	0.0235
2023-05-29 06:06:54,049 - Horizon 03 (MAE/RMSE/MAPE):	1.3836	2.9984	0.0289
2023-05-29 06:06:54,106 - Horizon 04 (MAE/RMSE/MAPE):	1.5531	3.4852	0.0335
2023-05-29 06:06:54,165 - Horizon 05 (MAE/RMSE/MAPE):	1.6919	3.8689	0.0375
2023-05-29 06:06:54,222 - Horizon 06 (MAE/RMSE/MAPE):	1.8099	4.1771	0.0410
2023-05-29 06:06:54,279 - Horizon 07 (MAE/RMSE/MAPE):	1.9136	4.4356	0.0442
2023-05-29 06:06:54,337 - Horizon 08 (MAE/RMSE/MAPE):	2.0061	4.6568	0.0471
2023-05-29 06:06:54,395 - Horizon 09 (MAE/RMSE/MAPE):	2.0890	4.8466	0.0497
2023-05-29 06:06:54,453 - Horizon 10 (MAE/RMSE/MAPE):	2.1650	5.0164	0.0522
2023-05-29 06:06:54,512 - Horizon 11 (MAE/RMSE/MAPE):	2.2358	5.1726	0.0545
2023-05-29 06:06:54,571 - Horizon 12 (MAE/RMSE/MAPE):	2.3035	5.3195	0.0566
2023-05-29 06:16:06,926 - Epoch 31: {'loss': 1.7403197288513184, 'val_loss': 1.9015069007873535, 'lr': 1.0000001e-08}
2023-05-29 06:25:19,199 - Epoch 32: {'loss': 1.7402280569076538, 'val_loss': 1.9015060663223267, 'lr': 1.0000001e-08}
2023-05-29 06:34:31,127 - Epoch 33: {'loss': 1.740276575088501, 'val_loss': 1.901505708694458, 'lr': 1.0000001e-09}
2023-05-29 06:43:43,157 - Epoch 34: {'loss': 1.7401776313781738, 'val_loss': 1.9015060663223267, 'lr': 1.0000001e-09}
2023-05-29 06:52:55,284 - Epoch 35: {'loss': 1.740360975265503, 'val_loss': 1.9015053510665894, 'lr': 1.0000001e-10}
2023-05-29 07:02:07,052 - Epoch 36: {'loss': 1.7401659488677979, 'val_loss': 1.9015055894851685, 'lr': 1.0000001e-10}
2023-05-29 07:11:18,873 - Epoch 37: {'loss': 1.7403512001037598, 'val_loss': 1.901505708694458, 'lr': 1.0000001e-11}
2023-05-29 07:20:30,881 - Epoch 38: {'loss': 1.7402830123901367, 'val_loss': 1.9015055894851685, 'lr': 1.0000001e-11}
2023-05-29 07:21:30,507 - Final test:
2023-05-29 07:21:31,077 - Horizon 01 (MAE/RMSE/MAPE):	0.8708	1.6031	0.0167
2023-05-29 07:21:31,622 - Horizon 02 (MAE/RMSE/MAPE):	1.1679	2.3835	0.0235
2023-05-29 07:21:32,023 - Horizon 03 (MAE/RMSE/MAPE):	1.3836	2.9984	0.0289
2023-05-29 07:21:32,352 - Horizon 04 (MAE/RMSE/MAPE):	1.5531	3.4852	0.0335
2023-05-29 07:21:32,606 - Horizon 05 (MAE/RMSE/MAPE):	1.6919	3.8689	0.0375
2023-05-29 07:21:32,806 - Horizon 06 (MAE/RMSE/MAPE):	1.8099	4.1771	0.0410
2023-05-29 07:21:33,008 - Horizon 07 (MAE/RMSE/MAPE):	1.9136	4.4356	0.0442
2023-05-29 07:21:33,191 - Horizon 08 (MAE/RMSE/MAPE):	2.0061	4.6568	0.0471
2023-05-29 07:21:33,381 - Horizon 09 (MAE/RMSE/MAPE):	2.0890	4.8466	0.0497
2023-05-29 07:21:33,561 - Horizon 10 (MAE/RMSE/MAPE):	2.1650	5.0164	0.0522
2023-05-29 07:21:33,743 - Horizon 11 (MAE/RMSE/MAPE):	2.2358	5.1726	0.0545
2023-05-29 07:21:33,926 - Horizon 12 (MAE/RMSE/MAPE):	2.3035	5.3194	0.0566
