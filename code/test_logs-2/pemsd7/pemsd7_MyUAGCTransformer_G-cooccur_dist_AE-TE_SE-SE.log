2023-06-01 18:32:31,248 - Namespace(dataset='pemsd7', model_name='MyUAGCTransformer', graph_type='cooccur_dist', restore_model=False, train_again=True, activity_embedding=False, timestamp_embedding=True, sensor_embedding=True, sensor_node2vec=False, P=12, Q=9, D=64, K=8, d=8, L=4, K_diffusion=3, filter_type='dual_random_walk', train_ratio=0.7, val_ratio=0.1, test_ratio=0.2, batch_size=32, max_epoch=100, optimizer='adam', learning_rate=0.001, patience_stop=5, patience_lr=2, graph_file='../graph_generation/pemsd7/urban_activity_sim_ua.pkl')
2023-06-01 18:32:40,609 - Callback method `on_train_batch_end` is slow compared to the batch time (batch time: 0.1853s vs `on_train_batch_end` time: 0.2154s). Check your callbacks.
2023-06-01 18:34:50,061 - Epoch 1: {'loss': 4.324427127838135, 'val_loss': 3.004612922668457, 'lr': 0.001}
2023-06-01 18:37:01,544 - Epoch 2: {'loss': 2.924147367477417, 'val_loss': 2.796787977218628, 'lr': 0.001}
2023-06-01 18:39:13,050 - Epoch 3: {'loss': 2.7490386962890625, 'val_loss': 2.766751289367676, 'lr': 0.001}
2023-06-01 18:41:24,650 - Epoch 4: {'loss': 2.681063413619995, 'val_loss': 2.7344655990600586, 'lr': 0.001}
2023-06-01 18:43:36,007 - Epoch 5: {'loss': 2.6470603942871094, 'val_loss': 2.6948087215423584, 'lr': 0.001}
2023-06-01 18:45:47,392 - Epoch 6: {'loss': 2.5851659774780273, 'val_loss': 2.693087577819824, 'lr': 0.001}
2023-06-01 18:47:58,928 - Epoch 7: {'loss': 2.508296251296997, 'val_loss': 2.5322577953338623, 'lr': 0.001}
2023-06-01 18:50:10,034 - Epoch 8: {'loss': 2.4253334999084473, 'val_loss': 2.567891836166382, 'lr': 0.001}
2023-06-01 18:52:21,312 - Epoch 9: {'loss': 2.377537250518799, 'val_loss': 2.4230217933654785, 'lr': 0.001}
2023-06-01 18:54:32,477 - Epoch 10: {'loss': 2.3077282905578613, 'val_loss': 2.4851391315460205, 'lr': 0.001}
2023-06-01 18:54:47,068 - Horizon 01 (MAE/RMSE/MAPE):	1.6125	2.6557	0.0367
2023-06-01 18:54:47,075 - Horizon 02 (MAE/RMSE/MAPE):	1.9396	3.3964	0.0443
2023-06-01 18:54:47,082 - Horizon 03 (MAE/RMSE/MAPE):	2.2116	4.0452	0.0516
2023-06-01 18:54:47,090 - Horizon 04 (MAE/RMSE/MAPE):	2.4295	4.5700	0.0579
2023-06-01 18:54:47,097 - Horizon 05 (MAE/RMSE/MAPE):	2.6061	4.9982	0.0633
2023-06-01 18:54:47,104 - Horizon 06 (MAE/RMSE/MAPE):	2.7661	5.3679	0.0682
2023-06-01 18:54:47,111 - Horizon 07 (MAE/RMSE/MAPE):	2.9175	5.6996	0.0729
2023-06-01 18:54:47,118 - Horizon 08 (MAE/RMSE/MAPE):	3.0532	5.9847	0.0774
2023-06-01 18:54:47,125 - Horizon 09 (MAE/RMSE/MAPE):	3.1463	6.1705	0.0805
2023-06-01 18:56:58,514 - Epoch 11: {'loss': 2.270695686340332, 'val_loss': 2.3748693466186523, 'lr': 0.001}
2023-06-01 18:59:09,724 - Epoch 12: {'loss': 2.23149037361145, 'val_loss': 2.4028990268707275, 'lr': 0.001}
2023-06-01 19:01:20,941 - Epoch 13: {'loss': 2.2406423091888428, 'val_loss': 2.4665520191192627, 'lr': 0.001}
2023-06-01 19:03:32,450 - Epoch 14: {'loss': 2.1208717823028564, 'val_loss': 2.3012266159057617, 'lr': 0.000100000005}
2023-06-01 19:05:43,963 - Epoch 15: {'loss': 2.1041202545166016, 'val_loss': 2.2998883724212646, 'lr': 0.000100000005}
2023-06-01 19:07:55,689 - Epoch 16: {'loss': 2.097356081008911, 'val_loss': 2.291771173477173, 'lr': 0.000100000005}
2023-06-01 19:10:06,844 - Epoch 17: {'loss': 2.092005491256714, 'val_loss': 2.2951371669769287, 'lr': 0.000100000005}
2023-06-01 19:12:18,036 - Epoch 18: {'loss': 2.0880119800567627, 'val_loss': 2.295715570449829, 'lr': 0.000100000005}
2023-06-01 19:14:29,619 - Epoch 19: {'loss': 2.0750608444213867, 'val_loss': 2.2885091304779053, 'lr': 1.0000001e-05}
2023-06-01 19:16:41,191 - Epoch 20: {'loss': 2.0732932090759277, 'val_loss': 2.2864441871643066, 'lr': 1.0000001e-05}
2023-06-01 19:16:54,605 - Horizon 01 (MAE/RMSE/MAPE):	1.3688	2.3354	0.0309
2023-06-01 19:16:54,612 - Horizon 02 (MAE/RMSE/MAPE):	1.7604	3.2078	0.0404
2023-06-01 19:16:54,620 - Horizon 03 (MAE/RMSE/MAPE):	2.0466	3.8815	0.0481
2023-06-01 19:16:54,627 - Horizon 04 (MAE/RMSE/MAPE):	2.2617	4.4048	0.0544
2023-06-01 19:16:54,634 - Horizon 05 (MAE/RMSE/MAPE):	2.4311	4.8265	0.0596
2023-06-01 19:16:54,642 - Horizon 06 (MAE/RMSE/MAPE):	2.5724	5.1693	0.0640
2023-06-01 19:16:54,649 - Horizon 07 (MAE/RMSE/MAPE):	2.6911	5.4502	0.0677
2023-06-01 19:16:54,656 - Horizon 08 (MAE/RMSE/MAPE):	2.7986	5.6936	0.0711
2023-06-01 19:16:54,663 - Horizon 09 (MAE/RMSE/MAPE):	2.8899	5.8857	0.0741
2023-06-01 19:19:05,925 - Epoch 21: {'loss': 2.0724949836730957, 'val_loss': 2.2891671657562256, 'lr': 1.0000001e-05}
2023-06-01 19:21:17,478 - Epoch 22: {'loss': 2.0718066692352295, 'val_loss': 2.284071445465088, 'lr': 1.0000001e-05}
2023-06-01 19:23:28,928 - Epoch 23: {'loss': 2.070664882659912, 'val_loss': 2.2821476459503174, 'lr': 1.0000001e-05}
2023-06-01 19:25:40,173 - Epoch 24: {'loss': 2.0703256130218506, 'val_loss': 2.28717303276062, 'lr': 1.0000001e-05}
2023-06-01 19:27:51,248 - Epoch 25: {'loss': 2.068826675415039, 'val_loss': 2.2831554412841797, 'lr': 1.0000001e-05}
2023-06-01 19:30:02,271 - Epoch 26: {'loss': 2.0676066875457764, 'val_loss': 2.2833218574523926, 'lr': 1.0000001e-06}
2023-06-01 19:32:13,360 - Epoch 27: {'loss': 2.0671534538269043, 'val_loss': 2.2846834659576416, 'lr': 1.0000001e-06}
2023-06-01 19:34:24,389 - Epoch 28: {'loss': 2.066554069519043, 'val_loss': 2.2844436168670654, 'lr': 1.0000001e-07}
2023-06-01 19:34:40,301 - Final test:
2023-06-01 19:34:40,322 - Horizon 01 (MAE/RMSE/MAPE):	1.3675	2.3332	0.0308
2023-06-01 19:34:40,341 - Horizon 02 (MAE/RMSE/MAPE):	1.7588	3.2053	0.0403
2023-06-01 19:34:40,360 - Horizon 03 (MAE/RMSE/MAPE):	2.0447	3.8783	0.0480
2023-06-01 19:34:40,379 - Horizon 04 (MAE/RMSE/MAPE):	2.2600	4.4017	0.0542
2023-06-01 19:34:40,398 - Horizon 05 (MAE/RMSE/MAPE):	2.4293	4.8219	0.0594
2023-06-01 19:34:40,417 - Horizon 06 (MAE/RMSE/MAPE):	2.5701	5.1626	0.0637
2023-06-01 19:34:40,436 - Horizon 07 (MAE/RMSE/MAPE):	2.6886	5.4423	0.0673
2023-06-01 19:34:40,455 - Horizon 08 (MAE/RMSE/MAPE):	2.7956	5.6848	0.0708
2023-06-01 19:34:40,474 - Horizon 09 (MAE/RMSE/MAPE):	2.8868	5.8776	0.0736
