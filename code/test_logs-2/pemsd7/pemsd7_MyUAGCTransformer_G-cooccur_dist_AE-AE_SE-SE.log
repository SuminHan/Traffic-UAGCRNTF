2023-05-30 07:47:10,368 - Namespace(dataset='pemsd7', model_name='MyUAGCTransformer', graph_type='cooccur_dist', restore_model=False, train_again=True, activity_embedding=True, timestamp_embedding=False, sensor_embedding=True, sensor_node2vec=False, P=12, Q=9, D=64, K=8, d=8, L=3, K_diffusion=3, filter_type='dual_random_walk', train_ratio=0.7, val_ratio=0.1, test_ratio=0.2, batch_size=32, max_epoch=100, optimizer='adam', learning_rate=0.001, patience_stop=5, patience_lr=2, graph_file='../graph_generation/pemsd7/urban_activity_sim_ua.pkl')
2023-05-30 07:47:17,722 - Callback method `on_train_batch_end` is slow compared to the batch time (batch time: 0.1344s vs `on_train_batch_end` time: 0.1664s). Check your callbacks.
2023-05-30 07:48:54,931 - Epoch 1: {'loss': 4.711828708648682, 'val_loss': 2.9367237091064453, 'lr': 0.001}
2023-05-30 07:50:33,537 - Epoch 2: {'loss': 2.882659673690796, 'val_loss': 2.8057351112365723, 'lr': 0.001}
2023-05-30 07:52:12,183 - Epoch 3: {'loss': 2.7664763927459717, 'val_loss': 2.762542247772217, 'lr': 0.001}
2023-05-30 07:53:50,901 - Epoch 4: {'loss': 2.7347400188446045, 'val_loss': 2.697246551513672, 'lr': 0.001}
2023-05-30 07:55:29,694 - Epoch 5: {'loss': 2.6746950149536133, 'val_loss': 2.6638259887695312, 'lr': 0.001}
2023-05-30 07:57:08,270 - Epoch 6: {'loss': 2.563007354736328, 'val_loss': 2.583203077316284, 'lr': 0.001}
2023-05-30 07:58:46,753 - Epoch 7: {'loss': 2.472668170928955, 'val_loss': 2.5748305320739746, 'lr': 0.001}
2023-05-30 08:00:24,986 - Epoch 8: {'loss': 2.4156153202056885, 'val_loss': 2.6536426544189453, 'lr': 0.001}
2023-05-30 08:02:03,556 - Epoch 9: {'loss': 2.3770811557769775, 'val_loss': 2.5326321125030518, 'lr': 0.001}
2023-05-30 08:03:42,198 - Epoch 10: {'loss': 2.3287253379821777, 'val_loss': 2.4487760066986084, 'lr': 0.001}
2023-05-30 08:03:53,190 - Horizon 01 (MAE/RMSE/MAPE):	1.5324	2.5929	0.0364
2023-05-30 08:03:53,197 - Horizon 02 (MAE/RMSE/MAPE):	1.9083	3.4433	0.0450
2023-05-30 08:03:53,204 - Horizon 03 (MAE/RMSE/MAPE):	2.1898	4.1002	0.0523
2023-05-30 08:03:53,211 - Horizon 04 (MAE/RMSE/MAPE):	2.4127	4.6245	0.0583
2023-05-30 08:03:53,218 - Horizon 05 (MAE/RMSE/MAPE):	2.5895	5.0354	0.0633
2023-05-30 08:03:53,225 - Horizon 06 (MAE/RMSE/MAPE):	2.7376	5.3718	0.0676
2023-05-30 08:03:53,232 - Horizon 07 (MAE/RMSE/MAPE):	2.8682	5.6573	0.0714
2023-05-30 08:03:53,239 - Horizon 08 (MAE/RMSE/MAPE):	2.9835	5.9018	0.0748
2023-05-30 08:03:53,246 - Horizon 09 (MAE/RMSE/MAPE):	3.0781	6.0985	0.0775
2023-05-30 08:05:31,607 - Epoch 11: {'loss': 2.31986665725708, 'val_loss': 2.4662559032440186, 'lr': 0.001}
2023-05-30 08:07:10,304 - Epoch 12: {'loss': 2.2698793411254883, 'val_loss': 2.412848711013794, 'lr': 0.001}
2023-05-30 08:08:48,943 - Epoch 13: {'loss': 2.262080192565918, 'val_loss': 2.37347674369812, 'lr': 0.001}
2023-05-30 08:10:27,382 - Epoch 14: {'loss': 2.2250173091888428, 'val_loss': 2.4326093196868896, 'lr': 0.001}
2023-05-30 08:12:05,698 - Epoch 15: {'loss': 2.21345591545105, 'val_loss': 2.4394168853759766, 'lr': 0.001}
2023-05-30 08:13:44,358 - Epoch 16: {'loss': 2.1179540157318115, 'val_loss': 2.3155102729797363, 'lr': 0.000100000005}
2023-05-30 08:15:22,725 - Epoch 17: {'loss': 2.1040358543395996, 'val_loss': 2.321571111679077, 'lr': 0.000100000005}
2023-05-30 08:17:01,160 - Epoch 18: {'loss': 2.0974137783050537, 'val_loss': 2.3170015811920166, 'lr': 0.000100000005}
2023-05-30 08:18:39,423 - Epoch 19: {'loss': 2.087421178817749, 'val_loss': 2.3166489601135254, 'lr': 1.0000001e-05}
2023-05-30 08:20:17,715 - Epoch 20: {'loss': 2.0858616828918457, 'val_loss': 2.317843437194824, 'lr': 1.0000001e-05}
2023-05-30 08:20:27,758 - Horizon 01 (MAE/RMSE/MAPE):	1.3577	2.3072	0.0307
2023-05-30 08:20:27,766 - Horizon 02 (MAE/RMSE/MAPE):	1.7580	3.2072	0.0404
2023-05-30 08:20:27,773 - Horizon 03 (MAE/RMSE/MAPE):	2.0615	3.9418	0.0488
2023-05-30 08:20:27,780 - Horizon 04 (MAE/RMSE/MAPE):	2.2797	4.4746	0.0553
2023-05-30 08:20:27,787 - Horizon 05 (MAE/RMSE/MAPE):	2.4552	4.9072	0.0609
2023-05-30 08:20:27,795 - Horizon 06 (MAE/RMSE/MAPE):	2.5972	5.2482	0.0654
2023-05-30 08:20:27,802 - Horizon 07 (MAE/RMSE/MAPE):	2.7161	5.5230	0.0693
2023-05-30 08:20:27,810 - Horizon 08 (MAE/RMSE/MAPE):	2.8196	5.7541	0.0727
2023-05-30 08:20:27,817 - Horizon 09 (MAE/RMSE/MAPE):	2.9028	5.9290	0.0752
2023-05-30 08:22:06,145 - Epoch 21: {'loss': 2.084406614303589, 'val_loss': 2.3158915042877197, 'lr': 1.0000001e-06}
2023-05-30 08:22:18,121 - Final test:
2023-05-30 08:22:18,142 - Horizon 01 (MAE/RMSE/MAPE):	1.3683	2.3236	0.0310
2023-05-30 08:22:18,162 - Horizon 02 (MAE/RMSE/MAPE):	1.7625	3.2132	0.0405
2023-05-30 08:22:18,182 - Horizon 03 (MAE/RMSE/MAPE):	2.0592	3.9262	0.0486
2023-05-30 08:22:18,201 - Horizon 04 (MAE/RMSE/MAPE):	2.2772	4.4539	0.0550
2023-05-30 08:22:18,220 - Horizon 05 (MAE/RMSE/MAPE):	2.4517	4.8807	0.0604
2023-05-30 08:22:18,239 - Horizon 06 (MAE/RMSE/MAPE):	2.5934	5.2197	0.0650
2023-05-30 08:22:18,258 - Horizon 07 (MAE/RMSE/MAPE):	2.7124	5.4975	0.0689
2023-05-30 08:22:18,277 - Horizon 08 (MAE/RMSE/MAPE):	2.8165	5.7334	0.0723
2023-05-30 08:22:18,296 - Horizon 09 (MAE/RMSE/MAPE):	2.9013	5.9135	0.0748
