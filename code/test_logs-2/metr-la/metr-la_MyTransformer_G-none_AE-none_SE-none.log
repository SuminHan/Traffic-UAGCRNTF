2023-05-29 03:28:34,072 - Namespace(dataset='metr-la', model_name='MyTransformer', graph_type='none', restore_model=False, activity_embedding=False, timestamp_embedding=False, sensor_embedding=False, sensor_node2vec=False, P=12, Q=12, D=64, K=8, d=8, L=3, K_diffusion=3, filter_type='dual_random_walk', train_ratio=0.7, val_ratio=0.1, test_ratio=0.2, batch_size=32, max_epoch=100, optimizer='adam', learning_rate=0.001, patience_stop=5, patience_lr=2)
2023-05-29 03:28:40,519 - Callback method `on_train_batch_end` is slow compared to the batch time (batch time: 0.1255s vs `on_train_batch_end` time: 0.1705s). Check your callbacks.
2023-05-29 03:32:34,849 - Epoch 1: {'loss': 4.135955333709717, 'val_loss': 3.6516411304473877, 'lr': 0.001}
2023-05-29 03:36:30,422 - Epoch 2: {'loss': 3.756370782852173, 'val_loss': 3.4606707096099854, 'lr': 0.001}
2023-05-29 03:40:25,761 - Epoch 3: {'loss': 3.720707416534424, 'val_loss': 3.478647470474243, 'lr': 0.001}
2023-05-29 03:44:21,302 - Epoch 4: {'loss': 3.678271532058716, 'val_loss': 3.445507526397705, 'lr': 0.001}
2023-05-29 03:48:16,702 - Epoch 5: {'loss': 3.648930788040161, 'val_loss': 3.471463441848755, 'lr': 0.001}
2023-05-29 03:52:11,959 - Epoch 6: {'loss': 3.6513283252716064, 'val_loss': 3.4513745307922363, 'lr': 0.001}
2023-05-29 03:56:07,435 - Epoch 7: {'loss': 3.604088068008423, 'val_loss': 3.422034502029419, 'lr': 0.000100000005}
2023-05-29 04:00:02,939 - Epoch 8: {'loss': 3.6019046306610107, 'val_loss': 3.417555809020996, 'lr': 0.000100000005}
2023-05-29 04:03:58,359 - Epoch 9: {'loss': 3.6017961502075195, 'val_loss': 3.4167888164520264, 'lr': 0.000100000005}
2023-05-29 04:07:53,841 - Epoch 10: {'loss': 3.6016201972961426, 'val_loss': 3.4132444858551025, 'lr': 0.000100000005}
2023-05-29 04:08:19,503 - Horizon 01 (MAE/RMSE/MAPE):	2.4255	4.3039	0.0595
2023-05-29 04:08:19,523 - Horizon 02 (MAE/RMSE/MAPE):	2.7936	5.3574	0.0715
2023-05-29 04:08:19,543 - Horizon 03 (MAE/RMSE/MAPE):	3.0754	6.0976	0.0812
2023-05-29 04:08:19,563 - Horizon 04 (MAE/RMSE/MAPE):	3.3240	6.6981	0.0899
2023-05-29 04:08:19,583 - Horizon 05 (MAE/RMSE/MAPE):	3.5521	7.2139	0.0978
2023-05-29 04:08:19,603 - Horizon 06 (MAE/RMSE/MAPE):	3.7705	7.6750	0.1054
2023-05-29 04:08:19,623 - Horizon 07 (MAE/RMSE/MAPE):	3.9753	8.0917	0.1127
2023-05-29 04:08:19,643 - Horizon 08 (MAE/RMSE/MAPE):	4.1696	8.4681	0.1199
2023-05-29 04:08:19,662 - Horizon 09 (MAE/RMSE/MAPE):	4.3554	8.8135	0.1266
2023-05-29 04:08:19,681 - Horizon 10 (MAE/RMSE/MAPE):	4.5358	9.1372	0.1333
2023-05-29 04:08:19,700 - Horizon 11 (MAE/RMSE/MAPE):	4.7114	9.4411	0.1397
2023-05-29 04:08:19,719 - Horizon 12 (MAE/RMSE/MAPE):	4.8847	9.7353	0.1459
2023-05-29 04:12:14,996 - Epoch 11: {'loss': 3.599480152130127, 'val_loss': 3.429211139678955, 'lr': 0.000100000005}
2023-05-29 04:16:10,286 - Epoch 12: {'loss': 3.598681688308716, 'val_loss': 3.4156055450439453, 'lr': 0.000100000005}
2023-05-29 04:20:05,780 - Epoch 13: {'loss': 3.5934503078460693, 'val_loss': 3.4078445434570312, 'lr': 1.0000001e-05}
2023-05-29 04:24:01,172 - Epoch 14: {'loss': 3.5918667316436768, 'val_loss': 3.4093217849731445, 'lr': 1.0000001e-05}
2023-05-29 04:27:56,635 - Epoch 15: {'loss': 3.5914998054504395, 'val_loss': 3.4074320793151855, 'lr': 1.0000001e-05}
2023-05-29 04:31:52,066 - Epoch 16: {'loss': 3.5923705101013184, 'val_loss': 3.407963275909424, 'lr': 1.0000001e-05}
2023-05-29 04:35:47,381 - Epoch 17: {'loss': 3.5911405086517334, 'val_loss': 3.410536527633667, 'lr': 1.0000001e-05}
2023-05-29 04:39:42,786 - Epoch 18: {'loss': 3.5913987159729004, 'val_loss': 3.4074532985687256, 'lr': 1.0000001e-06}
2023-05-29 04:43:38,315 - Epoch 19: {'loss': 3.590731382369995, 'val_loss': 3.407108783721924, 'lr': 1.0000001e-06}
2023-05-29 04:47:33,542 - Epoch 20: {'loss': 3.590973138809204, 'val_loss': 3.4074490070343018, 'lr': 1.0000001e-06}
2023-05-29 04:47:58,559 - Horizon 01 (MAE/RMSE/MAPE):	2.4146	4.2879	0.0588
2023-05-29 04:47:58,578 - Horizon 02 (MAE/RMSE/MAPE):	2.7856	5.3497	0.0712
2023-05-29 04:47:58,597 - Horizon 03 (MAE/RMSE/MAPE):	3.0687	6.0916	0.0810
2023-05-29 04:47:58,617 - Horizon 04 (MAE/RMSE/MAPE):	3.3179	6.6871	0.0900
2023-05-29 04:47:58,636 - Horizon 05 (MAE/RMSE/MAPE):	3.5465	7.1956	0.0983
2023-05-29 04:47:58,655 - Horizon 06 (MAE/RMSE/MAPE):	3.7652	7.6503	0.1062
2023-05-29 04:47:58,674 - Horizon 07 (MAE/RMSE/MAPE):	3.9700	8.0608	0.1138
2023-05-29 04:47:58,693 - Horizon 08 (MAE/RMSE/MAPE):	4.1648	8.4343	0.1212
2023-05-29 04:47:58,712 - Horizon 09 (MAE/RMSE/MAPE):	4.3505	8.7768	0.1282
2023-05-29 04:47:58,732 - Horizon 10 (MAE/RMSE/MAPE):	4.5305	9.0961	0.1350
2023-05-29 04:47:58,751 - Horizon 11 (MAE/RMSE/MAPE):	4.7054	9.3951	0.1418
2023-05-29 04:47:58,771 - Horizon 12 (MAE/RMSE/MAPE):	4.8761	9.6795	0.1483
2023-05-29 04:51:54,201 - Epoch 21: {'loss': 3.5908780097961426, 'val_loss': 3.4072015285491943, 'lr': 1.0000001e-06}
2023-05-29 04:55:49,537 - Epoch 22: {'loss': 3.5913665294647217, 'val_loss': 3.4071249961853027, 'lr': 1.0000001e-07}
2023-05-29 04:59:44,841 - Epoch 23: {'loss': 3.5907528400421143, 'val_loss': 3.4071266651153564, 'lr': 1.0000001e-07}
2023-05-29 05:03:40,173 - Epoch 24: {'loss': 3.5904529094696045, 'val_loss': 3.407120704650879, 'lr': 1.0000001e-08}
2023-05-29 05:04:06,827 - Final test:
2023-05-29 05:04:06,888 - Horizon 01 (MAE/RMSE/MAPE):	2.4143	4.2839	0.0588
2023-05-29 05:04:06,944 - Horizon 02 (MAE/RMSE/MAPE):	2.7852	5.3455	0.0711
2023-05-29 05:04:07,002 - Horizon 03 (MAE/RMSE/MAPE):	3.0683	6.0873	0.0810
2023-05-29 05:04:07,059 - Horizon 04 (MAE/RMSE/MAPE):	3.3175	6.6828	0.0899
2023-05-29 05:04:07,116 - Horizon 05 (MAE/RMSE/MAPE):	3.5460	7.1913	0.0982
2023-05-29 05:04:07,173 - Horizon 06 (MAE/RMSE/MAPE):	3.7647	7.6459	0.1061
2023-05-29 05:04:07,229 - Horizon 07 (MAE/RMSE/MAPE):	3.9695	8.0563	0.1138
2023-05-29 05:04:07,287 - Horizon 08 (MAE/RMSE/MAPE):	4.1642	8.4296	0.1211
2023-05-29 05:04:07,344 - Horizon 09 (MAE/RMSE/MAPE):	4.3499	8.7720	0.1281
2023-05-29 05:04:07,400 - Horizon 10 (MAE/RMSE/MAPE):	4.5298	9.0911	0.1349
2023-05-29 05:04:07,457 - Horizon 11 (MAE/RMSE/MAPE):	4.7046	9.3900	0.1417
2023-05-29 05:04:07,514 - Horizon 12 (MAE/RMSE/MAPE):	4.8753	9.6743	0.1482
