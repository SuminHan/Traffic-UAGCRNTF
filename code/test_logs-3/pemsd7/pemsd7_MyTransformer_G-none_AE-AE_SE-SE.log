2023-05-28 23:35:03,502 - Namespace(dataset='pemsd7', model_name='MyTransformer', graph_type='none', restore_model=False, activity_embedding=True, timestamp_embedding=False, sensor_embedding=True, sensor_node2vec=False, P=12, Q=9, D=64, K=8, d=8, L=3, K_diffusion=3, filter_type='dual_random_walk', train_ratio=0.7, val_ratio=0.1, test_ratio=0.2, batch_size=32, max_epoch=100, optimizer='adam', learning_rate=0.001, patience_stop=5, patience_lr=2)
2023-05-28 23:35:09,897 - Callback method `on_train_batch_end` is slow compared to the batch time (batch time: 0.1207s vs `on_train_batch_end` time: 0.1499s). Check your callbacks.
2023-05-28 23:36:36,794 - Epoch 1: {'loss': 3.5857837200164795, 'val_loss': 3.0145864486694336, 'lr': 0.001}
2023-05-28 23:38:04,675 - Epoch 2: {'loss': 2.815796375274658, 'val_loss': 2.7864701747894287, 'lr': 0.001}
2023-05-28 23:39:32,528 - Epoch 3: {'loss': 2.667879343032837, 'val_loss': 2.671529531478882, 'lr': 0.001}
2023-05-28 23:41:00,190 - Epoch 4: {'loss': 2.596339464187622, 'val_loss': 2.710808277130127, 'lr': 0.001}
2023-05-28 23:42:28,053 - Epoch 5: {'loss': 2.500807762145996, 'val_loss': 2.632601261138916, 'lr': 0.001}
2023-05-28 23:43:55,827 - Epoch 6: {'loss': 2.432183027267456, 'val_loss': 2.525653839111328, 'lr': 0.001}
2023-05-28 23:45:23,780 - Epoch 7: {'loss': 2.3949031829833984, 'val_loss': 2.4982693195343018, 'lr': 0.001}
2023-05-28 23:46:51,341 - Epoch 8: {'loss': 2.372450351715088, 'val_loss': 2.5665009021759033, 'lr': 0.001}
2023-05-28 23:48:18,997 - Epoch 9: {'loss': 2.338195562362671, 'val_loss': 2.5444774627685547, 'lr': 0.001}
2023-05-28 23:49:46,766 - Epoch 10: {'loss': 2.251382827758789, 'val_loss': 2.4767284393310547, 'lr': 0.000100000005}
2023-05-28 23:49:56,369 - Horizon 01 (MAE/RMSE/MAPE):	1.3911	2.3744	0.0316
2023-05-28 23:49:56,376 - Horizon 02 (MAE/RMSE/MAPE):	1.8123	3.3351	0.0421
2023-05-28 23:49:56,383 - Horizon 03 (MAE/RMSE/MAPE):	2.1465	4.1407	0.0518
2023-05-28 23:49:56,390 - Horizon 04 (MAE/RMSE/MAPE):	2.3902	4.7314	0.0594
2023-05-28 23:49:56,399 - Horizon 05 (MAE/RMSE/MAPE):	2.5723	5.1754	0.0652
2023-05-28 23:49:56,406 - Horizon 06 (MAE/RMSE/MAPE):	2.7214	5.5322	0.0701
2023-05-28 23:49:56,413 - Horizon 07 (MAE/RMSE/MAPE):	2.8452	5.8192	0.0741
2023-05-28 23:49:56,420 - Horizon 08 (MAE/RMSE/MAPE):	2.9441	6.0341	0.0771
2023-05-28 23:49:56,427 - Horizon 09 (MAE/RMSE/MAPE):	3.0196	6.1858	0.0793
2023-05-28 23:51:23,949 - Epoch 11: {'loss': 2.2397236824035645, 'val_loss': 2.484720468521118, 'lr': 0.000100000005}
2023-05-28 23:52:51,809 - Epoch 12: {'loss': 2.2352511882781982, 'val_loss': 2.4575717449188232, 'lr': 0.000100000005}
2023-05-28 23:54:19,699 - Epoch 13: {'loss': 2.2312538623809814, 'val_loss': 2.4518158435821533, 'lr': 0.000100000005}
2023-05-28 23:55:47,271 - Epoch 14: {'loss': 2.2276742458343506, 'val_loss': 2.47305965423584, 'lr': 0.000100000005}
2023-05-28 23:57:14,798 - Epoch 15: {'loss': 2.225337028503418, 'val_loss': 2.459071397781372, 'lr': 0.000100000005}
2023-05-28 23:58:42,626 - Epoch 16: {'loss': 2.212101459503174, 'val_loss': 2.45066237449646, 'lr': 1.0000001e-05}
2023-05-29 00:00:10,508 - Epoch 17: {'loss': 2.210862636566162, 'val_loss': 2.4486730098724365, 'lr': 1.0000001e-05}
2023-05-29 00:01:38,166 - Epoch 18: {'loss': 2.2104828357696533, 'val_loss': 2.4524002075195312, 'lr': 1.0000001e-05}
2023-05-29 00:03:05,875 - Epoch 19: {'loss': 2.21038818359375, 'val_loss': 2.451603412628174, 'lr': 1.0000001e-05}
2023-05-29 00:04:33,417 - Epoch 20: {'loss': 2.20817494392395, 'val_loss': 2.4506280422210693, 'lr': 1.0000001e-06}
2023-05-29 00:04:42,222 - Horizon 01 (MAE/RMSE/MAPE):	1.3725	2.3485	0.0310
2023-05-29 00:04:42,229 - Horizon 02 (MAE/RMSE/MAPE):	1.8062	3.3298	0.0418
2023-05-29 00:04:42,236 - Horizon 03 (MAE/RMSE/MAPE):	2.1346	4.1243	0.0513
2023-05-29 00:04:42,243 - Horizon 04 (MAE/RMSE/MAPE):	2.3725	4.7052	0.0586
2023-05-29 00:04:42,251 - Horizon 05 (MAE/RMSE/MAPE):	2.5509	5.1451	0.0643
2023-05-29 00:04:42,257 - Horizon 06 (MAE/RMSE/MAPE):	2.6941	5.4928	0.0690
2023-05-29 00:04:42,264 - Horizon 07 (MAE/RMSE/MAPE):	2.8117	5.7682	0.0728
2023-05-29 00:04:42,272 - Horizon 08 (MAE/RMSE/MAPE):	2.9073	5.9787	0.0757
2023-05-29 00:04:42,279 - Horizon 09 (MAE/RMSE/MAPE):	2.9835	6.1335	0.0779
2023-05-29 00:06:09,935 - Epoch 21: {'loss': 2.207782506942749, 'val_loss': 2.453031063079834, 'lr': 1.0000001e-06}
2023-05-29 00:07:37,550 - Epoch 22: {'loss': 2.208127021789551, 'val_loss': 2.451739549636841, 'lr': 1.0000001e-07}
2023-05-29 00:07:48,130 - Final test:
2023-05-29 00:07:48,151 - Horizon 01 (MAE/RMSE/MAPE):	1.3716	2.3469	0.0309
2023-05-29 00:07:48,170 - Horizon 02 (MAE/RMSE/MAPE):	1.8048	3.3277	0.0418
2023-05-29 00:07:48,189 - Horizon 03 (MAE/RMSE/MAPE):	2.1333	4.1200	0.0513
2023-05-29 00:07:48,208 - Horizon 04 (MAE/RMSE/MAPE):	2.3711	4.6991	0.0585
2023-05-29 00:07:48,227 - Horizon 05 (MAE/RMSE/MAPE):	2.5493	5.1383	0.0642
2023-05-29 00:07:48,247 - Horizon 06 (MAE/RMSE/MAPE):	2.6928	5.4864	0.0689
2023-05-29 00:07:48,267 - Horizon 07 (MAE/RMSE/MAPE):	2.8106	5.7625	0.0727
2023-05-29 00:07:48,286 - Horizon 08 (MAE/RMSE/MAPE):	2.9065	5.9738	0.0756
2023-05-29 00:07:48,305 - Horizon 09 (MAE/RMSE/MAPE):	2.9826	6.1291	0.0778
